<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE preface
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter version="5.0" xml:id="cha.quick.configuration"
  xmlns="http://docbook.org/ns/docbook"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xlink="http://www.w3.org/1999/xlink">
 <info>
  <title>Configuration</title>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  &productname; is typically configured in two stages: first, during the
  installation process, and subsequently, using <literal>cloud-init</literal>
  and/or &dashboard; settings page. During the initial installation, &productname;
  comes as preconfigured as possible.
 </para>

 <sect1 xml:id="sec.quick.configuration.second-stage">
  <title>Deployment Scenarios Requiring Second-stage Configuration</title>

  <para>
   Second-stage configuration is typically used for large-scale clusters built
   using pre-installed virtual machine disk images. Because these images are
   pre-installed, the installation program does not run, and so it is not
   possible to choose options interactively. Therefore, they must be specified
   in configuration files.
  </para>

  <para>
   For smaller clusters of just a few nodes, <literal>cloud-init</literal> is
   generally not necessary, and so it is not described here in the &instquick;
   Guide. For information on using <literal>cloud-init</literal>, refer to the
   Configuration chapter in the &deploy;.
  </para>

  <para>
   The following section describes the default values for the system
   configuration. If you require different settings than these, follow the
   &deploy; to build your cluster.
  </para>
 </sect1>

 <sect1 xml:id="sec.quick.configuration.defaults">
  <title>Defaults</title>

  <para>
   The following are the defaults for the first stage of configuration:
  </para>

  <variablelist>
   <varlistentry>
    <term>timezone</term>
    <listitem>
     <para>
      This is set to <emphasis>UTC</emphasis> by default. It is not recommended
      to change this, but it is possible using <literal>cloud-init</literal>;
      see the &deploy;.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>keyboard</term>
    <listitem>
     <para>
      This is set to <emphasis>us</emphasis> by default. If desired, choose an
      alternative layout from the list on the first screen of the installation
      program.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>locale</term>
    <listitem>
     <para>
      This is set to <emphasis>en_US.utf8</emphasis> by default, but can be
      changed by <literal>cloud-init</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="installation.velumsettings">
  <title>&dashboard; Settings</title>

  <para>
   Configuration within &dashboard; after bootstrap is available under the Settings
   page. Registries, External Authentication and some &kube; options are
   configurable:
  </para>

  <sect2>
   <title>LDAP Connector Settings</title>
   <note>
    <title>LDAP Anonymous Binding</title>
    <para>
     Anonymous binding is available, if allowed by the LDAP server.
    </para>
   </note>
   <para>
    Configure the cluster to authenticate &dashboard; and &kube; users against a
    pre-existing Lightweight Directory Access Protocol (LDAP)
    server and use <link xlink:href="https://ldap.com/ldap-filters/">LDAP Filters</link>
    to select the scope of users that will be permitted access.
   </para>

   <para>
    Access the LDAP configuration settings under <guimenu>Settings
    &rarr; EXTERNAL AUTHENTICATION &rarr; LDAP Connectors</guimenu>.
   </para>
   <para>
    Click on <guimenu>Add LDAP connector</guimenu> to add a new connector.
   </para>
   <informalfigure>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="velum_settings_ldap.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="velum_settings_ldap.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </informalfigure>
   <variablelist>
    <varlistentry>
     <term>Name</term>
     <listitem>
      <para>
       Name for the LDAP connection.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3>
    <title>Server</title>
    <para>
     Basic settings for the LDAP server host.
    </para>
    <variablelist>
     <varlistentry>
      <term>Host</term>
      <listitem>
       <para>
        Hostname of the LDAP server used for this connection.
       </para>
       <note>
        <title>Provide the hostname as FQDN</title>
        <para>
         The <guimenu>Host</guimenu> field must use a Fully Qualified Domain
         Name, as IP address is not allowed with TLS.
        </para>
       </note>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Port</term>
      <listitem>
       <para>
<!-- FIXME What's the default here? -->
        Connection to LDAP server requires TLS via StartTLS on port
        <literal>636</literal> or SimpleTLS or port <literal>389</literal>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>StartTLS</term>
      <listitem>
       <para>
        Choose whether you wish to use StartTLS for authentication or not.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Certificate</term>
      <listitem>
       <para>
        The <guimenu>Certificate</guimenu> field must be a Base64-encoded PEM
        key.
       </para>
       <note>
        <title>Remove the enclosing lines</title>
        <para>
         You must enter the certificate body only. This means only the content
         between the <literal>-----BEGIN CERTIFICATE-----</literal> and
         <literal>-----END CERTIFICATE-----</literal> lines but not those lines
         themselves.
        </para>
       </note>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>Authentication</title>
    <variablelist>
     <varlistentry>
      <term>Anonymous</term>
      <listitem>
       <para>
        Selects if you wish to perform an anonymous bind with the LDAP server.
        If set to <guimenu>False</guimenu> you must provide a
        <guimenu>DN</guimenu> and a <guimenu>Password</guimenu>. The latter two
        are hidden when the slider is set to <guimenu>True</guimenu>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>DN</term>
      <listitem>
       <para>
        Distinguished Name used for the authentication.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Password</term>
      <listitem>
       <para>
        Password for the <guimenu>DN</guimenu> doing the authentication.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>User Search</title>
    <para>
     <!-- FIXME Add description of what this set of fields does -->
    </para>
    <variablelist>
     <varlistentry>
      <term>Username Prompt</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Base DN</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Filter</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>User Attribute Map</title>
    <para>
     <!-- FIXME Add description of what this set of fields does -->
    </para>
    <variablelist>
     <varlistentry>
      <term>Username</term>
      <listitem>
       <para>
         <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ID</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Email</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Name</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>Group Search</title>
    <para>
     <!-- FIXME Add description of what this set of fields does -->
    </para>
    <variablelist>
     <varlistentry>
      <term>Base DN</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Filter</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>Group Attribute Map</title>
    <para>
     <!-- FIXME Add description of what this set of fields does -->
    </para>
    <variablelist>
     <varlistentry>
      <term>User</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Group</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Name</term>
      <listitem>
       <para>
        <!-- FIXME Fill in description -->
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
</chapter>
